<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Berryly Belle - Hijab Anggun & Modern</title>
    
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&family=Poppins:wght@400;500;600&display=swap" rel="stylesheet">
    
    <!-- Font Awesome for Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    
    <!-- Custom Styles -->
    <style>
        html { scroll-behavior: smooth; }
        body { font-family: 'Poppins', sans-serif; background-color: #fdf6f9; }
        .font-playfair { font-family: 'Playfair Display', serif; }
        .text-brand { color: #9a2768; }
        .bg-brand { background-color: #9a2768; }
        .border-brand { border-color: #9a2768; }

        .reveal-on-scroll { opacity: 0; transform: translateY(30px); transition: opacity 0.8s ease-out, transform 0.8s ease-out; }
        .reveal-on-scroll.visible { opacity: 1; transform: translateY(0); }

        @keyframes float { 0% { transform: translateY(0px); } 50% { transform: translateY(-10px); } 100% { translateY(0px); } }
        .butterfly { animation: float 3s ease-in-out infinite; }
        
        .cloud-bg { background-image: url('https://raw.githubusercontent.com/idantexe/berrylybelle/refs/heads/main/background.webp'); background-repeat: no-repeat; background-position: center; background-size: cover; }
        
        #cart-items::-webkit-scrollbar, #checkout-modal .overflow-y-auto::-webkit-scrollbar { width: 6px; }
        #cart-items::-webkit-scrollbar-track, #checkout-modal .overflow-y-auto::-webkit-scrollbar-track { background: #f1f1f1; }
        #cart-items::-webkit-scrollbar-thumb, #checkout-modal .overflow-y-auto::-webkit-scrollbar-thumb { background: #c4c4c4; border-radius: 6px; }
        #cart-items::-webkit-scrollbar-thumb:hover, #checkout-modal .overflow-y-auto::-webkit-scrollbar-thumb:hover { background: #a1a1a1; }

        .loader { border: 4px solid #f3f3f3; border-top: 4px solid #9a2768; border-radius: 50%; width: 24px; height: 24px; animation: spin 1s linear infinite; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        .spinner {
            width: 20px;
            height: 20px;
            border: 2px solid #f3f3f3;
            border-top: 2px solid #9a2768;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
    </style>
</head>
<body class="text-gray-800">

    <!-- Header / Navbar -->
    <header class="bg-white/80 backdrop-blur-sm sticky top-0 z-40 shadow-sm">
        <div class="container mx-auto px-6 py-4 flex justify-between items-center">
            <a href="#home" class="nav-link">
                <img src="https://raw.githubusercontent.com/idantexe/berrylybelle/refs/heads/main/logoooo.webp" alt="Berryly Belle Logo" class="h-16">
            </a>
            <nav class="hidden md:flex items-center space-x-8">
                <a href="#home" class="nav-link text-gray-600 hover:text-brand transition duration-300">Home</a>
                <a href="#products" class="nav-link text-gray-600 hover:text-brand transition duration-300">Produk</a>
                <a href="#process" class="nav-link text-gray-600 hover:text-brand transition duration-300">Cara Pesan</a>
                <a href="#contact" class="nav-link text-gray-600 hover:text-brand transition duration-300">Kontak</a>
            </nav>
            <div class="flex items-center">
                <button id="cart-button" type="button" class="relative mr-4">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-brand" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z" /></svg>
                    <span id="cart-count" class="absolute -top-2 -right-2 bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center">0</span>
                </button>
                <button id="mobile-menu-button" type="button" class="md:hidden">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-brand" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7" /></svg>
                </button>
            </div>
        </div>
        <div id="mobile-menu" class="hidden md:hidden px-6 pb-4">
            <a href="#home" class="nav-link block py-2 text-gray-600 hover:text-brand">Home</a>
            <a href="#products" class="nav-link block py-2 text-gray-600 hover:text-brand">Produk</a>
            <a href="#process" class="nav-link block py-2 text-gray-600 hover:text-brand">Cara Pesan</a>
            <a href="#contact" class="nav-link block py-2 text-gray-600 hover:text-brand">Kontak</a>
        </div>
    </header>
    <main>
        <!-- Sections: Home, Welcome, Products, Process, Contact -->
        <section id="home" class="w-full cloud-bg">
            <div class="container mx-auto px-6 py-16 md:py-24 flex flex-col md:flex-row items-center overflow-hidden">
                 <div class="md:w-1/2 text-center md:text-left reveal-on-scroll">
                    <h1 class="font-playfair text-6xl md:text-8xl font-bold text-brand leading-tight">Hijab</h1>
                    <p class="font-playfair text-2xl text-brand mt-2">Berryly Belle</p>
                    <p class="text-gray-600 mt-4 max-w-md mx-auto md:mx-0">"Anggun dalam Kesederhanaan, Indah dalam Setiap Balutan."</p>
                    <a href="https://www.berrylybelle.com" target="_blank" class="text-brand mt-6 inline-block border-b border-brand hover:text-gray-600 transition">www.berrylybelle.com</a>
                </div>
                <div class="md:w-1/2 mt-12 md:mt-0 flex justify-center relative reveal-on-scroll" style="transition-delay: 200ms;">
                    <div class="relative w-80 h-[28rem]">
                        <img src="https://raw.githubusercontent.com/idantexe/berrylybelle/refs/heads/main/model%20landing%20page.webp" alt="Model mengenakan hijab Berryly Belle" class="w-full h-full object-cover rounded-t-[150px] rounded-b-lg border-4 border-pink-200 shadow-lg">
                        <img src="https://raw.githubusercontent.com/idantexe/berrylybelle/refs/heads/main/kupu.webp" alt="Kupu-kupu" class="w-16 h-auto absolute -top-4 -left-4 butterfly -scale-x-100">
                    </div>
                </div>
            </div>
        </section>
        <section class="container mx-auto px-6 py-16 md:py-24 flex flex-col md:flex-row-reverse items-center gap-12">
            <div class="md:w-1/2 text-center md:text-left reveal-on-scroll">
                <h2 class="font-playfair text-4xl md:text-5xl font-bold text-brand">Selamat Datang Di Toko Hijab Kami</h2>
                <p class="text-gray-600 mt-6">Toko Hijab Modern hadir untuk memberikan koleksi kerudung stylish, nyaman, dan berkualitas. Kami percaya setiap wanita berhak tampil anggun dengan harga terjangkau.</p>
                <a href="#products" class="nav-link bg-brand text-white px-8 py-3 rounded-full hover:opacity-90 transition duration-300 inline-flex items-center mt-8 group">
                    Lihat Koleksi
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 ml-2 group-hover:translate-x-1 transition-transform" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10.293 3.293a1 1 0 011.414 0l6 6a1 1 0 010 1.414l-6 6a1 1 0 01-1.414-1.414L14.586 11H3a1 1 0 110-2h11.586l-4.293-4.293a1 1 0 010-1.414z" clip-rule="evenodd" /></svg>
                </a>
            </div>
            <div class="md:w-1/2 flex justify-center reveal-on-scroll" style="transition-delay: 200ms;">
                <div class="relative w-80 h-[28rem]">
                    <img src="https://raw.githubusercontent.com/idantexe/berrylybelle/refs/heads/main/model%20landing%20page%202.webp" alt="Model mengenakan hijab pink" class="w-full h-full object-cover rounded-t-[150px] rounded-b-lg border-4 border-pink-200 shadow-lg">
                </div>
            </div>
        </section>
        <section id="products" class="py-16 md:py-24 bg-white/50 cloud-bg">
            <div class="container mx-auto px-6 text-center">
                <h2 class="font-playfair text-4xl md:text-5xl font-bold text-brand reveal-on-scroll">Koleksi Pilihan Kami</h2>
                <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-12 mt-12">
                    <!-- Produk 1 - Tidak ada perubahan -->
                    <div class="product-card reveal-on-scroll" data-id="1" data-name="Kerudung Premium Organza" data-price="45000" data-image="https://raw.githubusercontent.com/idantexe/berrylybelle/refs/heads/main/kerudung%20premium.webp" data-weight="150">
                        <div class="bg-white p-4 rounded-full shadow-lg w-64 h-64 mx-auto flex items-center justify-center"><img src="https://raw.githubusercontent.com/idantexe/berrylybelle/refs/heads/main/kerudung%20premium.webp" alt="Kerudung Premium Organza" class="w-full h-full object-cover rounded-full"></div>
                        <h3 class="font-semibold text-xl mt-6">Kerudung Premium Organza</h3>
                        <p class="text-brand font-medium">Rp 45.000</p>
                        <button type="button" class="add-to-cart-btn mt-4 bg-brand text-white px-6 py-2 rounded-full hover:opacity-90 transition">Tambah ke Keranjang</button>
                    </div>
                    <!-- Produk 2 - DITAMBAHKAN object-right -->
                    <div class="product-card reveal-on-scroll" style="transition-delay: 200ms;" data-id="2" data-name="Kerudung Segi Empat Polly Cotton" data-price="55000" data-image="https://raw.githubusercontent.com/idantexe/berrylybelle/refs/heads/main/Kerudung%20segi%20empat.webp" data-weight="200">
                        <div class="bg-white p-4 rounded-full shadow-lg w-64 h-64 mx-auto flex items-center justify-center"><img src="https://raw.githubusercontent.com/idantexe/berrylybelle/refs/heads/main/Kerudung%20segi%20empat.webp" alt="Kerudung Segi Empat Polly Cotton" class="w-full h-full object-cover rounded-full object-right"></div>
                        <h3 class="font-semibold text-xl mt-6">Kerudung Segi Empat Polly Cotton</h3>
                        <p class="text-brand font-medium">Rp 55.000</p>
                        <button type="button" class="add-to-cart-btn mt-4 bg-brand text-white px-6 py-2 rounded-full hover:opacity-90 transition">Tambah ke Keranjang</button>
                    </div>
                    <!-- Produk 3 - DITAMBAHKAN object-right -->
                    <div class="product-card reveal-on-scroll" style="transition-delay: 400ms;" data-id="3" data-name="Kerudung Pashmina Ceruty" data-price="65000" data-image="https://raw.githubusercontent.com/idantexe/berrylybelle/refs/heads/main/Kerudung%20phasmina.webp" data-weight="250">
                        <div class="bg-white p-4 rounded-full shadow-lg w-64 h-64 mx-auto flex items-center justify-center"><img src="https://raw.githubusercontent.com/idantexe/berrylybelle/refs/heads/main/Kerudung%20phasmina.webp" alt="Kerudung Pashmina Ceruty" class="w-full h-full object-cover rounded-full object-right"></div>
                        <h3 class="font-semibold text-xl mt-6">Kerudung Pashmina Ceruty</h3>
                        <p class="text-brand font-medium">Rp 65.000</p>
                        <button type="button" class="add-to-cart-btn mt-4 bg-brand text-white px-6 py-2 rounded-full hover:opacity-90 transition">Tambah ke Keranjang</button>
                    </div>
                </div>
            </div>
        </section>
        <section id="process" class="py-16 md:py-24">
             <div class="container mx-auto px-6">
                <h2 class="font-playfair text-4xl md:text-5xl font-bold text-brand text-center reveal-on-scroll">Proses Belanja Online yang Efisien</h2>
                <div class="mt-16 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                    <div class="flex items-start space-x-4 reveal-on-scroll"><div class="bg-brand text-white rounded-full w-12 h-12 flex-shrink-0 flex items-center justify-center text-xl font-bold">1</div><div><h3 class="font-semibold text-lg">Pilih Produk & Tambah ke Keranjang</h3><p class="text-gray-600 mt-1">Jelajahi koleksi kami dan pilih produk favorit Anda.</p></div></div>
                    <div class="flex items-start space-x-4 reveal-on-scroll" style="transition-delay: 150ms;"><div class="bg-brand text-white rounded-full w-12 h-12 flex-shrink-0 flex items-center justify-center text-xl font-bold">2</div><div><h3 class="font-semibold text-lg">Isi Formulir & Cek Ongkir</h3><p class="text-gray-600 mt-1">Lengkapi data diri, alamat, dan pilih layanan pengiriman.</p></div></div>
                    <div class="flex items-start space-x-4 reveal-on-scroll" style="transition-delay: 300ms;"><div class="bg-brand text-white rounded-full w-12 h-12 flex-shrink-0 flex items-center justify-center text-xl font-bold">3</div><div><h3 class="font-semibold text-lg">Kirim Pesanan via WhatsApp</h3><p class="text-gray-600 mt-1">Rincian pesanan lengkap dengan ongkir akan otomatis dibuat.</p></div></div>
                </div>
            </div>
        </section>
        <section id="contact" class="py-16 md:py-24 bg-white/50">
            <div class="container mx-auto px-6">
                <h2 class="font-playfair text-4xl md:text-5xl font-bold text-brand text-center reveal-on-scroll">Hubungi Kami</h2>
                <p class="text-gray-600 mt-4 max-w-2xl mx-auto text-center reveal-on-scroll">Kami senang mendengar dari Anda. Kunjungi kami atau kirimkan pesan.</p>
                <div class="mt-16 grid grid-cols-1 md:grid-cols-2 gap-12">
                    <div class="reveal-on-scroll">
                        <div class="space-y-4 mb-8">
                            <div class="flex items-center space-x-4"><i class="fa-solid fa-location-dot text-brand text-xl w-6 text-center"></i><span>Sukamulya, Kota Bandung</span></div>
                            <div class="flex items-center space-x-4"><i class="fa-solid fa-envelope text-brand text-xl w-6 text-center"></i><span>berrylybell@gmail.com</span></div>
                            <div class="flex items-center space-x-4"><i class="fa-solid fa-phone text-brand text-xl w-6 text-center"></i><span>0819-1482-8763</span></div>
                        </div>
                        <form id="contact-form">
                            <div class="mb-4"><label for="contact-name" class="sr-only">Nama</label><input type="text" id="contact-name" placeholder="Nama Anda" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-1 focus:ring-brand"></div>
                            <div class="mb-4"><label for="contact-email" class="sr-only">Email</label><input type="email" id="contact-email" placeholder="Email Anda" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-1 focus:ring-brand"></div>
                            <div class="mb-4"><label for="contact-message" class="sr-only">Pesan</label><textarea id="contact-message" rows="4" placeholder="Pesan Anda" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-1 focus:ring-brand"></textarea></div>
                            <button type="submit" class="w-full bg-brand text-white py-3 rounded-lg hover:opacity-90 transition">Kirim Pesan</button>
                        </form>
                    </div>
                    <div class="reveal-on-scroll" style="transition-delay: 200ms;">
                        <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3960.902330342921!2d107.5731175758641!3d-6.90223336754454!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x2e68e63982264e59%3A0x537365a6a3253723!2sBandung%2C%20Kota%20Bandung%2C%20Jawa%20Barat!5e0!3m2!1sid!2sid!4v1690882823123!5m2!1sid!2sid" width="100%" height="450" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade" class="rounded-lg shadow-lg"></iframe>
                    </div>
                </div>
            </div>
        </section>
    </main>
    <footer class="bg-gray-800 text-white">
        <div class="container mx-auto px-6 py-8">
            <div class="flex justify-center space-x-6 mb-6">
                <a class="text-gray-400 hover:text-white transition cursor-pointer"><i class="fab fa-facebook-f fa-lg"></i></a>
                <a class="text-gray-400 hover:text-white transition cursor-pointer"><i class="fab fa-instagram fa-lg"></i></a>
                <a class="text-gray-400 hover:text-white transition cursor-pointer"><i class="fab fa-tiktok fa-lg"></i></a>
                <a class="text-gray-400 hover:text-white transition cursor-pointer"><i class="fab fa-whatsapp fa-lg"></i></a>
            </div>
            <p class="text-center text-gray-400 text-sm">&copy; 2025 Berryly Belle. All Rights Reserved. Dibuat dengan ❤️.</p>
        </div>
    </footer>

    <!-- Cart Modal -->
    <div id="cart-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
        <div class="bg-white rounded-lg shadow-xl w-full max-w-2xl m-4 max-h-[90vh] flex flex-col">
            <div class="flex justify-between items-center p-4 border-b">
                <h2 class="text-xl font-semibold text-gray-800">Keranjang Belanja</h2>
                <button id="close-cart-btn" type="button" class="text-gray-500 hover:text-gray-800 text-2xl leading-none">&times;</button>
            </div>
            <div id="cart-items" class="p-6 overflow-y-auto">
                <!-- Cart items will be injected here -->
            </div>
            <div id="cart-footer" class="p-6 border-t bg-gray-50 rounded-b-lg">
                 <div class="flex mb-4">
                    <input type="text" id="promo-code-input" placeholder="Masukkan Kode Promo" class="flex-grow px-3 py-2 border border-gray-300 rounded-l-lg focus:outline-none focus:ring-1 focus:ring-brand">
                    <button type="button" id="apply-promo-btn" class="px-4 py-2 bg-gray-300 text-gray-800 rounded-r-lg hover:bg-gray-400">Gunakan</button>
                </div>
                <div id="promo-feedback" class="text-sm mb-4"></div>
                <div class="flex justify-between items-center text-lg">
                    <span class="text-gray-600">Subtotal</span>
                    <span id="cart-subtotal" class="font-semibold text-gray-800"></span>
                </div>
                <div id="discount-row" class="flex justify-between items-center text-sm hidden">
                    <span class="text-green-600">Diskon</span>
                    <span id="cart-discount" class="font-semibold text-green-600"></span>
                </div>
                <hr class="my-2">
                <div class="flex justify-between items-center text-lg font-bold mb-4">
                    <span>Total</span>
                    <span id="cart-grandtotal"></span>
                </div>
                <button id="proceed-to-checkout-btn" type="button" class="w-full bg-brand text-white py-3 rounded-lg font-semibold hover:opacity-90 transition disabled:opacity-50 disabled:cursor-not-allowed">
                    Lanjut ke Checkout
                </button>
            </div>
             <div id="empty-cart-view" class="p-10 text-center hidden">
                <svg class="mx-auto h-12 w-12 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
                    <path vector-effect="non-scaling-stroke" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z" />
                </svg>
                <h3 class="mt-2 text-lg font-medium text-gray-900">Keranjang Anda Kosong</h3>
                <p class="mt-1 text-sm text-gray-500">Ayo, temukan hijab favoritmu!</p>
                <div class="mt-6">
                    <button id="continue-shopping-btn" type="button" class="inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-brand hover:opacity-90">
                        Lanjut Belanja
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Checkout Modal -->
    <div id="checkout-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[60] hidden">
        <div class="bg-white rounded-lg shadow-xl w-full max-w-lg m-4 max-h-[90vh] flex flex-col">
            <h2 class="text-2xl font-bold text-brand p-6 border-b text-center">Formulir Pemesanan</h2>
            <div class="p-6 overflow-y-auto">
                <form id="checkout-form">
                    <!-- Personal Info -->
                    <div class="mb-4"><label for="name" class="block text-sm font-medium text-gray-700 mb-1">Nama Lengkap</label><input type="text" id="name" name="name" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-1 focus:ring-brand"></div>
                    <div class="mb-4"><label for="phone" class="block text-sm font-medium text-gray-700 mb-1">Nomor WhatsApp (Aktif)</label><input type="tel" id="phone" name="phone" required placeholder="Contoh: 081234567890" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-1 focus:ring-brand"></div>
                    
                    <!-- Shipping Address -->
                    <h3 class="text-lg font-semibold text-gray-800 mt-6 mb-2 border-t pt-4">Alamat Pengiriman</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                        <div>
                            <label for="province" class="block text-sm font-medium text-gray-700 mb-1">Provinsi</label>
                            <select id="province" name="province" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-1 focus:ring-brand bg-white">
                                <option value="">Pilih Provinsi...</option>
                            </select>
                        </div>
                        <div>
                            <label for="city" class="block text-sm font-medium text-gray-700 mb-1 flex items-center">
                                Kota/Kabupaten <span id="city-loader" class="spinner ml-2 hidden"></span>
                            </label>
                            <select id="city" name="city" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-1 focus:ring-brand bg-gray-200" disabled>
                                <option value="">Pilih Kota/Kabupaten...</option>
                            </select>
                        </div>
                    </div>
                    <div class="mb-4"><label for="address" class="block text-sm font-medium text-gray-700 mb-1">Alamat Lengkap (Jalan, No. Rumah, Kelurahan, dll)</label><textarea id="address" name="address" rows="3" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-1 focus:ring-brand"></textarea></div>

                    <!-- Shipping Courier -->
                    <h3 class="text-lg font-semibold text-gray-800 mt-6 mb-2 border-t pt-4">Opsi Pengiriman</h3>
                    <div class="mb-4">
                        <label for="courier" class="block text-sm font-medium text-gray-700 mb-1">Pilih Kurir</label>
                        <select id="courier" name="courier" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-1 focus:ring-brand bg-white">
                            <option value="">Pilih Kurir...</option>
                            <option value="jne">JNE</option>
                            <option value="pos">POS Indonesia</option>
                            <option value="tiki">TIKI</option>
                        </select>
                    </div>
                    <div id="shipping-cost-container" class="mt-4 p-4 bg-pink-50 rounded-lg hidden">
                        <p class="font-semibold text-gray-700">Pilih Layanan Pengiriman:</p>
                        <div id="shipping-cost-loader" class="flex items-center my-2">
                            <div class="spinner mr-2"></div>
                            <span>Mencari ongkos kirim...</span>
                        </div>
                        <div id="shipping-cost-result" class="space-y-2 mt-2"></div>
                        <p id="shipping-cost-error" class="text-red-500 text-sm mt-2"></p>
                    </div>
                </form>
            </div>
            <div class="p-6 border-t bg-gray-50 rounded-b-lg">
                <div class="flex justify-between items-center mb-2"><span class="text-gray-600">Subtotal Produk</span><span id="summary-subtotal" class="font-semibold"></span></div>
                <div class="flex justify-between items-center mb-2"><span class="text-gray-600">Ongkos Kirim</span><span id="summary-shipping" class="font-semibold">Rp 0</span></div>
                <hr class="my-2">
                <div class="flex justify-between items-center text-xl font-bold text-brand"><span >Total Pembayaran</span><span id="summary-grandtotal"></span></div>
                <div class="flex justify-end space-x-4 mt-6">
                    <button type="button" id="cancel-checkout-btn" class="px-6 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300">Batal</button>
                    <button type="submit" form="checkout-form" id="submit-order-btn" class="px-6 py-2 bg-brand text-white rounded-lg hover:opacity-90 disabled:opacity-50 disabled:cursor-not-allowed">Kirim Pesanan via WhatsApp</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Overlay for modals -->
    <div id="overlay" class="fixed inset-0 bg-black bg-opacity-30 z-40 hidden"></div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // --- KONFIGURASI ---
            const WHATSAPP_NUMBER = '6281914828763';
            const BINDERBYTE_API_KEY = '990c2606587d7318c449e8eacbe3334f6dc9eea23c71d569b4481b4b058a8630';
            // PENTING: Tentukan ID kota asal pengiriman Anda.
            // Anda bisa cari ID kota Anda menggunakan API Binderbyte, atau lihat di dropdown setelah memilih provinsi.
            // Contoh: Kota Bandung ID = 3273
            const ORIGIN_CITY_ID = '3273'; // Ganti dengan ID kota asal Anda

            // --- TEMPAT ANDA MEMBUAT KODE PROMO ---
            const PROMO_CODES = {
                "DISKON10RB": { type: 'fixed', value: 10000 },
                "HEMAT15": { type: 'percent', value: 15 }
            };
            
            // --- STATE ---
            let cart = [];
            let appliedPromo = null;
            let selectedShipping = null;

            // --- SELECTORS ---
            const cartButton = document.getElementById('cart-button'),
                  cartModal = document.getElementById('cart-modal'),
                  closeCartBtn = document.getElementById('close-cart-btn'),
                  cartCount = document.getElementById('cart-count'),
                  cartItemsContainer = document.getElementById('cart-items'),
                  cartFooter = document.getElementById('cart-footer'),
                  emptyCartView = document.getElementById('empty-cart-view'),
                  cartSubtotal = document.getElementById('cart-subtotal'),
                  cartGrandtotal = document.getElementById('cart-grandtotal'),
                  discountRow = document.getElementById('discount-row'),
                  cartDiscount = document.getElementById('cart-discount'),
                  promoCodeInput = document.getElementById('promo-code-input'),
                  applyPromoBtn = document.getElementById('apply-promo-btn'),
                  promoFeedback = document.getElementById('promo-feedback'),
                  proceedToCheckoutBtn = document.getElementById('proceed-to-checkout-btn'),
                  continueShoppingBtn = document.getElementById('continue-shopping-btn'),
                  overlay = document.getElementById('overlay'),
                  checkoutModal = document.getElementById('checkout-modal'),
                  cancelCheckoutBtn = document.getElementById('cancel-checkout-btn'),
                  checkoutForm = document.getElementById('checkout-form'),
                  addToCartButtons = document.querySelectorAll('.add-to-cart-btn'),
                  summarySubtotal = document.getElementById('summary-subtotal'),
                  summaryShipping = document.getElementById('summary-shipping'),
                  summaryGrandtotal = document.getElementById('summary-grandtotal'),
                  submitOrderBtn = document.getElementById('submit-order-btn'),
                  navLinks = document.querySelectorAll('.nav-link'),
                  contactForm = document.getElementById('contact-form'),
                  mobileMenu = document.getElementById('mobile-menu'),
                  mobileMenuButton = document.getElementById('mobile-menu-button'),
                  provinceSelect = document.getElementById('province'),
                  citySelect = document.getElementById('city'),
                  cityLoader = document.getElementById('city-loader'),
                  courierSelect = document.getElementById('courier'),
                  shippingCostContainer = document.getElementById('shipping-cost-container'),
                  shippingCostLoader = document.getElementById('shipping-cost-loader'),
                  shippingCostResult = document.getElementById('shipping-cost-result'),
                  shippingCostError = document.getElementById('shipping-cost-error');

            // --- FUNCTIONS ---
            const formatCurrency = (amount) => new Intl.NumberFormat('id-ID', { style: 'currency', currency: 'IDR', minimumFractionDigits: 0 }).format(amount);

            const calculateTotals = () => {
                const subtotal = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
                let discountAmount = 0;

                if (appliedPromo) {
                    if (appliedPromo.type === 'fixed') {
                        discountAmount = appliedPromo.value;
                    } else if (appliedPromo.type === 'percent') {
                        discountAmount = (subtotal * appliedPromo.value) / 100;
                    }
                }
                
                const shippingCost = selectedShipping ? selectedShipping.cost : 0;
                const grandTotal = subtotal - discountAmount + shippingCost;

                return { subtotal, discountAmount, shippingCost, grandTotal };
            };

            const updateCartView = () => {
                const totals = calculateTotals();
                
                cartSubtotal.textContent = formatCurrency(totals.subtotal);
                if (totals.discountAmount > 0) {
                    discountRow.classList.remove('hidden');
                    cartDiscount.textContent = `- ${formatCurrency(totals.discountAmount)}`;
                } else {
                    discountRow.classList.add('hidden');
                }
                cartGrandtotal.textContent = formatCurrency(totals.grandTotal - totals.shippingCost); // Grand total di cart tidak termasuk ongkir
                cartCount.textContent = cart.reduce((sum, item) => sum + item.quantity, 0);
                proceedToCheckoutBtn.disabled = cart.length === 0;

                if (cart.length === 0) {
                    cartItemsContainer.classList.add('hidden');
                    cartFooter.classList.add('hidden');
                    emptyCartView.classList.remove('hidden');
                } else {
                    cartItemsContainer.classList.remove('hidden');
                    cartFooter.classList.remove('hidden');
                    emptyCartView.classList.add('hidden');
                    
                    cartItemsContainer.innerHTML = '';
                    cart.forEach(item => {
                        const itemEl = document.createElement('div');
                        itemEl.className = 'flex items-center justify-between py-4 border-b';
                        itemEl.innerHTML = `
                            <div class="flex items-center space-x-4">
                                <img src="${item.image}" alt="${item.name}" class="w-16 h-16 object-cover rounded-md">
                                <div>
                                    <p class="font-semibold text-gray-800">${item.name}</p>
                                    <p class="text-sm text-gray-500">${formatCurrency(item.price)}</p>
                                </div>
                            </div>
                            <div class="flex items-center space-x-4">
                                <div class="flex items-center border rounded-md">
                                    <button type="button" class="quantity-btn px-2 py-1 text-gray-600" data-id="${item.id}" data-action="decrease">-</button>
                                    <span class="px-3">${item.quantity}</span>
                                    <button type="button" class="quantity-btn px-2 py-1 text-gray-600" data-id="${item.id}" data-action="increase">+</button>
                                </div>
                                <button type="button" class="remove-item-btn text-red-500 hover:text-red-700" data-id="${item.id}"><i class="fas fa-trash-alt"></i></button>
                            </div>
                        `;
                        cartItemsContainer.appendChild(itemEl);
                    });
                }
            };

            const updateCheckoutSummary = () => {
                const totals = calculateTotals();
                summarySubtotal.textContent = formatCurrency(totals.subtotal);
                summaryShipping.textContent = formatCurrency(totals.shippingCost);
                summaryGrandtotal.textContent = formatCurrency(totals.grandTotal);
            };

            const showOverlay = () => overlay.classList.remove('hidden');
            const hideOverlay = () => overlay.classList.add('hidden');

            const openCartModal = () => {
                updateCartView();
                cartModal.classList.remove('hidden');
                showOverlay();
            };
            const closeCartModal = () => {
                cartModal.classList.add('hidden');
                if (checkoutModal.classList.contains('hidden')) {
                    hideOverlay();
                }
            };
            const openCheckoutModal = () => {
                closeCartModal();
                updateCheckoutSummary();
                checkoutModal.classList.remove('hidden');
                showOverlay();
            };
            const closeCheckoutModal = () => {
                checkoutModal.classList.add('hidden');
                hideOverlay();
            };
            
            const handleAddToCart = (e) => {
                const card = e.target.closest('.product-card');
                const { id, name, price, image, weight } = card.dataset;
                const existingItem = cart.find(item => item.id === id);
                if (existingItem) {
                    existingItem.quantity++;
                } else {
                    cart.push({ id, name, price: parseInt(price), image, weight: parseInt(weight), quantity: 1 });
                }
                openCartModal();
            };
            
            const handleCartActions = (e) => {
                const target = e.target.closest('.quantity-btn, .remove-item-btn');
                if (!target) return;
                const id = target.dataset.id;
                const item = cart.find(item => item.id === id);
                if (!item) return;

                if (target.classList.contains('quantity-btn')) {
                    if (target.dataset.action === 'increase') item.quantity++;
                    else if (target.dataset.action === 'decrease') {
                        item.quantity--;
                        if (item.quantity === 0) cart = cart.filter(cartItem => cartItem.id !== id);
                    }
                } else if (target.classList.contains('remove-item-btn')) {
                    cart = cart.filter(cartItem => cartItem.id !== id);
                }
                updateCartView();
            };
            
            const handleApplyPromo = () => {
                const code = promoCodeInput.value.toUpperCase();
                const promo = PROMO_CODES[code];

                if (promo) {
                    appliedPromo = promo;
                    promoFeedback.textContent = `Kode promo "${code}" berhasil diterapkan!`;
                    promoFeedback.className = 'text-sm mb-4 text-green-600';
                } else {
                    appliedPromo = null;
                    promoFeedback.textContent = 'Kode promo tidak valid.';
                    promoFeedback.className = 'text-sm mb-4 text-red-600';
                }
                updateCartView();
            };

            const handleCheckoutSubmit = (e) => {
                e.preventDefault();
                const formData = new FormData(checkoutForm);
                const name = formData.get('name');
                const phone = formData.get('phone');
                const provinceName = provinceSelect.options[provinceSelect.selectedIndex].text;
                const cityName = citySelect.options[citySelect.selectedIndex].text;
                const address = formData.get('address');
                
                const totals = calculateTotals();

                let promoText = '';
                if (appliedPromo) {
                    promoText = `Diskon (${promoCodeInput.value.toUpperCase()}): -${formatCurrency(totals.discountAmount)}\n`;
                }
                
                let shippingText = 'Ongkos Kirim: (Belum dihitung)\n';
                if (selectedShipping) {
                    shippingText = `Ongkos Kirim (${selectedShipping.service.toUpperCase()}): ${formatCurrency(selectedShipping.cost)}\n`;
                }

                let message = `Halo Berryly Belle, saya mau pesan:\n\n*PESANAN SAYA:*\n`;
                cart.forEach(item => { message += `- ${item.name} (x${item.quantity})\n`; });
                message += `\n*DATA PENGIRIMAN:*\nNama: ${name}\nNo. HP: ${phone}\nAlamat: ${address}, ${cityName}, ${provinceName}\n\n`;
                message += `*DETAIL PEMBAYARAN:*\nSubtotal: ${formatCurrency(totals.subtotal)}\n`;
                if (appliedPromo) {
                    message += promoText;
                }
                message += shippingText;
                message += `*Total Pembayaran: ${formatCurrency(totals.grandTotal)}*\n\n`;
                message += `Terima kasih.`;
                
                const whatsappUrl = `https://api.whatsapp.com/send?phone=${WHATSAPP_NUMBER}&text=${encodeURIComponent(message)}`;
                window.open(whatsappUrl, '_blank');
            };

            const checkFormValidity = () => {
                submitOrderBtn.disabled = !checkoutForm.checkValidity();
            };

            // --- Shipping Functions ---
            const loadProvinces = async () => {
                try {
                    const response = await fetch(`https://api.binderbyte.com/wilayah/provinsi?api_key=${BINDERBYTE_API_KEY}`);
                    const data = await response.json();
                    if (data.value) {
                        data.value.forEach(province => {
                            const option = document.createElement('option');
                            option.value = province.id;
                            option.textContent = province.name;
                            provinceSelect.appendChild(option);
                        });
                    }
                } catch (error) {
                    console.error("Error loading provinces:", error);
                }
            };

            const loadCities = async (provinceId) => {
                if (!provinceId) return;
                citySelect.innerHTML = '<option value="">Pilih Kota/Kabupaten...</option>';
                citySelect.disabled = true;
                citySelect.classList.add('bg-gray-200');
                cityLoader.classList.remove('hidden');

                try {
                    const response = await fetch(`https://api.binderbyte.com/wilayah/kabupaten?api_key=${BINDERBYTE_API_KEY}&id_provinsi=${provinceId}`);
                    const data = await response.json();
                    if (data.value) {
                        data.value.forEach(city => {
                            const option = document.createElement('option');
                            option.value = city.id;
                            option.textContent = city.name;
                            citySelect.appendChild(option);
                        });
                        citySelect.disabled = false;
                        citySelect.classList.remove('bg-gray-200');
                    }
                } catch (error) {
                    console.error("Error loading cities:", error);
                } finally {
                    cityLoader.classList.add('hidden');
                }
            };
            
            const calculateShippingCost = async () => {
                const destination = citySelect.value;
                const courier = courierSelect.value;
                const totalWeight = cart.reduce((sum, item) => sum + (item.weight * item.quantity), 0);

                if (!destination || !courier || totalWeight === 0) {
                    shippingCostContainer.classList.add('hidden');
                    return;
                }

                shippingCostContainer.classList.remove('hidden');
                shippingCostLoader.classList.remove('hidden');
                shippingCostResult.innerHTML = '';
                shippingCostError.textContent = '';
                selectedShipping = null;
                updateCheckoutSummary();

                // =================================================================================
                // == PENTING: INTEGRASI API ONGKOS KIRIM (CONTOH: RAJAONGKIR) DILAKUKAN DI SINI ==
                // =================================================================================
                // Kode di bawah ini adalah SIMULASI. Anda harus menggantinya dengan panggilan
                // fetch ke API ongkos kirim yang sebenarnya.
                
                console.log(`Simulating shipping cost check:
                    Origin: ${ORIGIN_CITY_ID}
                    Destination: ${destination}
                    Weight: ${totalWeight} gr
                    Courier: ${courier}`);

                // --- GANTI BAGIAN INI DENGAN FETCH API SEBENARNYA ---
                // Contoh fetch ke RajaOngkir (membutuhkan backend/proxy untuk keamanan API Key):
                /*
                try {
                    const response = await fetch('URL_BACKEND_ANDA_untuk_cek_ongkir', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            origin: ORIGIN_CITY_ID,
                            destination: destination,
                            weight: totalWeight,
                            courier: courier
                        })
                    });
                    const data = await response.json();

                    // Asumsikan 'data' berisi hasil dari RajaOngkir
                    const results = data.rajaongkir.results[0].costs;
                    displayShippingOptions(results);

                } catch (error) {
                    console.error("Error calculating shipping:", error);
                    shippingCostError.textContent = "Gagal menghitung ongkos kirim. Silakan coba lagi.";
                } finally {
                    shippingCostLoader.classList.add('hidden');
                }
                */

                // --- SIMULASI DATA (HAPUS BAGIAN INI SETELAH INTEGRASI API SEBENARNYA) ---
                setTimeout(() => {
                    const fakeResults = [
                        { service: 'OKE', description: 'Ongkos Kirim Ekonomis', cost: [{ value: 18000, etd: '3-4' }] },
                        { service: 'REG', description: 'Layanan Reguler', cost: [{ value: 22000, etd: '1-2' }] },
                        { service: 'YES', description: 'Yakin Esok Sampai', cost: [{ value: 35000, etd: '1' }] }
                    ];
                    displayShippingOptions(fakeResults);
                    shippingCostLoader.classList.add('hidden');
                }, 1500); // Simulasi loading 1.5 detik
                // --- AKHIR BAGIAN SIMULASI ---
            };

            const displayShippingOptions = (options) => {
                shippingCostResult.innerHTML = '';
                if (!options || options.length === 0) {
                    shippingCostError.textContent = 'Tidak ada layanan pengiriman yang tersedia untuk tujuan ini.';
                    return;
                }

                options.forEach((option, index) => {
                    const cost = option.cost[0].value;
                    const etd = option.cost[0].etd;
                    const radioId = `shipping-${index}`;

                    const optionEl = document.createElement('div');
                    optionEl.className = 'flex items-center p-2 border rounded-lg hover:bg-pink-100';
                    optionEl.innerHTML = `
                        <input type="radio" id="${radioId}" name="shipping-option" class="h-4 w-4 text-brand focus:ring-brand border-gray-300"
                               data-cost="${cost}" data-service="${option.service}" data-etd="${etd}">
                        <label for="${radioId}" class="ml-3 block text-sm font-medium text-gray-900 w-full cursor-pointer">
                            <div class="flex justify-between items-center">
                                <div>
                                    <p class="font-bold">${option.service} (${option.description})</p>
                                    <p class="text-xs text-gray-500">Estimasi ${etd} hari</p>
                                </div>
                                <p class="font-semibold">${formatCurrency(cost)}</p>
                            </div>
                        </label>
                    `;
                    shippingCostResult.appendChild(optionEl);
                });
            };

            // --- EVENT LISTENERS ---
            cartButton.addEventListener('click', openCartModal);
            closeCartBtn.addEventListener('click', closeCartModal);
            overlay.addEventListener('click', () => { closeCartModal(); closeCheckoutModal(); });
            
            addToCartButtons.forEach(btn => btn.addEventListener('click', handleAddToCart));
            cartItemsContainer.addEventListener('click', handleCartActions);
            
            proceedToCheckoutBtn.addEventListener('click', openCheckoutModal);
            continueShoppingBtn.addEventListener('click', closeCartModal);
            cancelCheckoutBtn.addEventListener('click', closeCheckoutModal);
            
            applyPromoBtn.addEventListener('click', handleApplyPromo);
            
            checkoutForm.addEventListener('input', checkFormValidity);
            checkoutForm.addEventListener('submit', handleCheckoutSubmit);

            navLinks.forEach(anchor => {
                anchor.addEventListener('click', (e) => {
                    e.preventDefault();
                    const targetElement = document.querySelector(anchor.getAttribute('href'));
                    if (targetElement) {
                        targetElement.scrollIntoView({ behavior: 'smooth' });
                    }
                    mobileMenu.classList.add('hidden');
                });
            });

            mobileMenuButton.addEventListener('click', () => mobileMenu.classList.toggle('hidden'));

            contactForm.addEventListener('submit', (e) => {
                e.preventDefault();
                alert('Terima kasih! Pesan Anda telah terkirim.');
                contactForm.reset();
            });

            // Shipping event listeners
            provinceSelect.addEventListener('change', () => loadCities(provinceSelect.value));
            citySelect.addEventListener('change', calculateShippingCost);
            courierSelect.addEventListener('change', calculateShippingCost);

            shippingCostResult.addEventListener('change', (e) => {
                if (e.target.name === 'shipping-option') {
                    selectedShipping = {
                        cost: parseInt(e.target.dataset.cost),
                        service: e.target.dataset.service,
                        etd: e.target.dataset.etd
                    };
                    updateCheckoutSummary();
                }
            });
            
            // Initial calls
            loadProvinces();
            updateCartView();
        });
        
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => { if (entry.isIntersecting) entry.target.classList.add('visible'); });
        }, { threshold: 0.1 });
        document.querySelectorAll('.reveal-on-scroll').forEach(el => observer.observe(el));
    </script>

</body>
</html>
